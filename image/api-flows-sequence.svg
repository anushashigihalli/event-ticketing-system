<svg viewBox="0 0 1080 900" xmlns="http://www.w3.org/2000/svg" font-family="'Courier New', monospace">
  <defs>
    <marker id="arr" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0,10 3.5,0 7" fill="#334155"/>
    </marker>
    <marker id="arr-open" markerWidth="12" markerHeight="8" refX="11" refY="4" orient="auto">
      <polyline points="0,0 10,4 0,8" fill="none" stroke="#334155" stroke-width="1.5"/>
    </marker>
    <marker id="arr-grn" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0,10 3.5,0 7" fill="#16a34a"/>
    </marker>
    <filter id="sh">
      <feDropShadow dx="1" dy="2" stdDeviation="2.5" flood-color="#00000018"/>
    </filter>
  </defs>

  <rect width="1080" height="900" fill="#f8fafc"/>

  <!-- Master title -->
  <text x="540" y="24" text-anchor="middle" font-size="14" font-weight="bold" fill="#0f172a" letter-spacing="0.5">Â«sequenceÂ» API Happy-Path Flows â€” Create Event  Â·  Create Booking</text>

  <!-- Divider -->
  <line x1="540" y1="34" x2="540" y2="886" stroke="#e2e8f0" stroke-width="2" stroke-dasharray="10 5"/>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       LEFT â€” CREATE EVENT FLOW
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

  <!-- Section label -->
  <rect x="34" y="36" width="496" height="22" rx="4" fill="#0284c7"/>
  <text x="282" y="52" text-anchor="middle" font-size="11" font-weight="bold" fill="#fff" letter-spacing="0.5">POST /events â€” Create Event Flow</text>

  <!-- Lifeline X: Client=110  Server=282  DB=454 -->

  <!-- Headers -->
  <rect x="58"  y="64" width="104" height="40" rx="4" fill="#fff" stroke="#38bdf8" stroke-width="1.8" filter="url(#sh)"/>
  <text x="110" y="80" text-anchor="middle" font-size="9" font-style="italic" fill="#0369a1">Â«actorÂ»</text>
  <text x="110" y="96" text-anchor="middle" font-size="11" font-weight="bold" fill="#0f172a">Client</text>

  <rect x="230" y="64" width="104" height="40" rx="4" fill="#fff" stroke="#22c55e" stroke-width="1.8" filter="url(#sh)"/>
  <text x="282" y="80" text-anchor="middle" font-size="9" font-style="italic" fill="#15803d">Â«componentÂ»</text>
  <text x="282" y="96" text-anchor="middle" font-size="11" font-weight="bold" fill="#0f172a">Server</text>

  <rect x="402" y="64" width="104" height="40" rx="4" fill="#fff" stroke="#a78bfa" stroke-width="1.8" filter="url(#sh)"/>
  <text x="454" y="80" text-anchor="middle" font-size="9" font-style="italic" fill="#6d28d9">Â«databaseÂ»</text>
  <text x="454" y="96" text-anchor="middle" font-size="11" font-weight="bold" fill="#0f172a">Database</text>

  <!-- Lifelines -->
  <line x1="110" y1="104" x2="110" y2="876" stroke="#38bdf8" stroke-width="1.2" stroke-dasharray="6 4"/>
  <line x1="282" y1="104" x2="282" y2="876" stroke="#22c55e" stroke-width="1.2" stroke-dasharray="6 4"/>
  <line x1="454" y1="104" x2="454" y2="876" stroke="#a78bfa" stroke-width="1.2" stroke-dasharray="6 4"/>

  <!-- Activation bars -->
  <rect x="274" y="146" width="16" height="430" rx="2" fill="#bbf7d0" stroke="#22c55e" stroke-width="1"/>
  <rect x="446" y="290" width="16" height="122" rx="2" fill="#ede9fe" stroke="#a78bfa" stroke-width="1"/>
  <rect x="102" y="146" width="16" height="430" rx="2" fill="#e0f2fe" stroke="#38bdf8" stroke-width="1"/>

  <!-- 1. POST /events -->
  <line x1="118" y1="158" x2="272" y2="158" stroke="#334155" stroke-width="1.8" marker-end="url(#arr)"/>
  <text x="193" y="151" text-anchor="middle" font-size="10" font-weight="bold" fill="#0f172a">POST /events</text>

  <!-- Request body note -->
  <rect x="38" y="166" width="132" height="66" rx="3" fill="#f0f9ff" stroke="#7dd3fc" stroke-width="1" stroke-dasharray="4 2"/>
  <text x="54" y="181" font-size="9" fill="#0c4a6e">{ name: "Concert",</text>
  <text x="54" y="194" font-size="9" fill="#0c4a6e">  capacity: 100,</text>
  <text x="54" y="207" font-size="9" fill="#0c4a6e">  price: 50.00</text>
  <text x="54" y="220" font-size="9" fill="#0c4a6e">}</text>

  <!-- 2. Validate note -->
  <rect x="210" y="172" width="152" height="54" rx="3" fill="#f0fdf4" stroke="#4ade80" stroke-width="1"/>
  <text x="286" y="187" text-anchor="middle" font-size="9" font-style="italic" fill="#15803d">Â«validateÂ»</text>
  <text x="222" y="202" font-size="9" fill="#166534">â€¢ name not empty</text>
  <text x="222" y="215" font-size="9" fill="#166534">â€¢ capacity &gt; 0</text>

  <!-- 3. Set available = capacity -->
  <rect x="210" y="236" width="152" height="22" rx="3" fill="#f0fdf4" stroke="#4ade80" stroke-width="1"/>
  <text x="286" y="251" text-anchor="middle" font-size="9" fill="#15803d">available := capacity  (100)</text>

  <!-- 4. INSERT INTO events -->
  <line x1="290" y1="272" x2="444" y2="272" stroke="#334155" stroke-width="1.6" marker-end="url(#arr)"/>
  <text x="369" y="265" text-anchor="middle" font-size="9" font-weight="bold" fill="#0f172a">INSERT INTO events</text>

  <!-- 5. Return ID -->
  <line x1="444" y1="304" x2="290" y2="304" stroke="#475569" stroke-width="1.4" stroke-dasharray="5 3" marker-end="url(#arr-open)"/>
  <text x="369" y="297" text-anchor="middle" font-size="9" fill="#475569">LastInsertId = 1</text>

  <!-- Seq numbers L -->
  <circle cx="126" cy="158" r="8" fill="#0369a1"/><text x="126" y="162" text-anchor="middle" font-size="9" fill="#fff" font-weight="bold">1</text>
  <circle cx="297" cy="272" r="8" fill="#7c3aed"/><text x="297" y="276" text-anchor="middle" font-size="9" fill="#fff" font-weight="bold">2</text>
  <circle cx="439" cy="304" r="8" fill="#7c3aed"/><text x="439" y="308" text-anchor="middle" font-size="9" fill="#fff" font-weight="bold">3</text>

  <!-- Build response note -->
  <rect x="210" y="322" width="152" height="52" rx="3" fill="#f0fdf4" stroke="#4ade80" stroke-width="1"/>
  <text x="286" y="337" text-anchor="middle" font-size="9" font-style="italic" fill="#15803d">Â«build responseÂ»</text>
  <text x="222" y="352" font-size="9" fill="#166534">â€¢ set success: true</text>
  <text x="222" y="365" font-size="9" fill="#166534">â€¢ include event data</text>

  <!-- Log/status note -->
  <rect x="210" y="384" width="152" height="36" rx="3" fill="#fefce8" stroke="#fde047" stroke-width="1"/>
  <text x="286" y="399" text-anchor="middle" font-size="9" font-style="italic" fill="#713f12">Â«logÂ»</text>
  <text x="222" y="412" font-size="9" fill="#713f12">Event created id=1</text>

  <!-- 6. 201 Created -->
  <line x1="274" y1="450" x2="118" y2="450" stroke="#475569" stroke-width="1.5" stroke-dasharray="5 3" marker-end="url(#arr-open)"/>
  <text x="193" y="442" text-anchor="middle" font-size="10" font-weight="bold" fill="#16a34a">201 Created</text>

  <!-- Response body note -->
  <rect x="38" y="460" width="148" height="100" rx="3" fill="#f0fdf4" stroke="#4ade80" stroke-width="1" stroke-dasharray="4 2"/>
  <text x="54" y="476" font-size="9" fill="#166534">{ success: true,</text>
  <text x="54" y="490" font-size="9" fill="#166534">  data: {</text>
  <text x="54" y="504" font-size="9" fill="#166534">    id: 1,</text>
  <text x="54" y="518" font-size="9" fill="#166534">    name: "Concert",</text>
  <text x="54" y="532" font-size="9" fill="#166534">    available: 100</text>
  <text x="54" y="546" font-size="9" fill="#166534">} }</text>

  <circle cx="258" cy="450" r="8" fill="#16a34a"/><text x="258" y="454" text-anchor="middle" font-size="9" fill="#fff" font-weight="bold">4</text>

  <!-- Footer lifelines L -->
  <rect x="58"  y="876" width="104" height="18" rx="4" fill="#fff" stroke="#38bdf8" stroke-width="1.5"/>
  <text x="110" y="889" text-anchor="middle" font-size="10" fill="#0f172a">Client</text>
  <rect x="230" y="876" width="104" height="18" rx="4" fill="#fff" stroke="#22c55e" stroke-width="1.5"/>
  <text x="282" y="889" text-anchor="middle" font-size="10" fill="#0f172a">Server</text>
  <rect x="402" y="876" width="104" height="18" rx="4" fill="#fff" stroke="#a78bfa" stroke-width="1.5"/>
  <text x="454" y="889" text-anchor="middle" font-size="10" fill="#0f172a">Database</text>


  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       RIGHT â€” CREATE BOOKING FLOW
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

  <!-- Section label -->
  <rect x="550" y="36" width="496" height="22" rx="4" fill="#d97706"/>
  <text x="798" y="52" text-anchor="middle" font-size="11" font-weight="bold" fill="#fff" letter-spacing="0.5">POST /bookings â€” Create Booking Flow  (with Mutex)</text>

  <!-- Lifeline X: Client=614  Server=786  DB=958 -->

  <!-- Headers R -->
  <rect x="562" y="64" width="104" height="40" rx="4" fill="#fff" stroke="#38bdf8" stroke-width="1.8" filter="url(#sh)"/>
  <text x="614" y="80" text-anchor="middle" font-size="9" font-style="italic" fill="#0369a1">Â«actorÂ»</text>
  <text x="614" y="96" text-anchor="middle" font-size="11" font-weight="bold" fill="#0f172a">Client</text>

  <rect x="734" y="64" width="104" height="40" rx="4" fill="#fff" stroke="#f59e0b" stroke-width="1.8" filter="url(#sh)"/>
  <text x="786" y="80" text-anchor="middle" font-size="9" font-style="italic" fill="#b45309">Â«mutex / serverÂ»</text>
  <text x="786" y="96" text-anchor="middle" font-size="11" font-weight="bold" fill="#0f172a">Server</text>

  <rect x="906" y="64" width="104" height="40" rx="4" fill="#fff" stroke="#a78bfa" stroke-width="1.8" filter="url(#sh)"/>
  <text x="958" y="80" text-anchor="middle" font-size="9" font-style="italic" fill="#6d28d9">Â«databaseÂ»</text>
  <text x="958" y="96" text-anchor="middle" font-size="11" font-weight="bold" fill="#0f172a">Database</text>

  <!-- Lifelines R -->
  <line x1="614" y1="104" x2="614" y2="876" stroke="#38bdf8" stroke-width="1.2" stroke-dasharray="6 4"/>
  <line x1="786" y1="104" x2="786" y2="876" stroke="#f59e0b" stroke-width="1.2" stroke-dasharray="6 4"/>
  <line x1="958" y1="104" x2="958" y2="876" stroke="#a78bfa" stroke-width="1.2" stroke-dasharray="6 4"/>

  <!-- Activation bars R -->
  <rect x="778" y="146" width="16" height="600" rx="2" fill="#fef9c3" stroke="#f59e0b" stroke-width="1"/>
  <rect x="950" y="326" width="16" height="242" rx="2" fill="#ede9fe" stroke="#a78bfa" stroke-width="1"/>
  <rect x="606" y="146" width="16" height="600" rx="2" fill="#e0f2fe" stroke="#38bdf8" stroke-width="1"/>

  <!-- Transaction fragment -->
  <rect x="710" y="304" width="300" height="270" rx="3" fill="none" stroke="#6d28d9" stroke-width="1.4" stroke-dasharray="7 3"/>
  <rect x="710" y="304" width="80" height="16" rx="2" fill="#ede9fe" stroke="#6d28d9" stroke-width="1.3"/>
  <text x="750" y="316" text-anchor="middle" font-size="9" font-weight="bold" fill="#4c1d95">transaction</text>

  <!-- 1. POST /bookings -->
  <line x1="622" y1="158" x2="776" y2="158" stroke="#334155" stroke-width="1.8" marker-end="url(#arr)"/>
  <text x="701" y="151" text-anchor="middle" font-size="10" font-weight="bold" fill="#0f172a">POST /bookings</text>

  <!-- Request body note R -->
  <rect x="552" y="166" width="138" height="78" rx="3" fill="#fff7ed" stroke="#fed7aa" stroke-width="1" stroke-dasharray="4 2"/>
  <text x="566" y="181" font-size="9" fill="#7c2d12">{ event_id: 1,</text>
  <text x="566" y="195" font-size="9" fill="#7c2d12">  user_email:</text>
  <text x="566" y="209" font-size="9" fill="#7c2d12">   "a@b.com",</text>
  <text x="566" y="223" font-size="9" fill="#7c2d12">  quantity: 2</text>
  <text x="566" y="237" font-size="9" fill="#7c2d12">}</text>

  <!-- 2. Validate note R -->
  <rect x="716" y="168" width="148" height="52" rx="3" fill="#f0fdf4" stroke="#4ade80" stroke-width="1"/>
  <text x="790" y="183" text-anchor="middle" font-size="9" font-style="italic" fill="#15803d">Â«validateÂ»</text>
  <text x="728" y="197" font-size="9" fill="#166534">â€¢ event_id &gt; 0</text>
  <text x="728" y="210" font-size="9" fill="#166534">â€¢ quantity &gt; 0</text>

  <!-- 3. Lock mutex (self-loop) -->
  <path d="M 794 242 Q 840 242 840 252 Q 840 262 794 262" fill="none" stroke="#f59e0b" stroke-width="2" marker-end="url(#arr)"/>
  <!-- Lock Mutex pill â€” shifted left to stay in bounds -->
  <rect x="844" y="246" width="112" height="18" rx="9" fill="#fef3c7" stroke="#f59e0b" stroke-width="1.3"/>
  <text x="900" y="258" text-anchor="middle" font-size="9" font-weight="bold" fill="#92400e">ðŸ”’ Lock Mutex</text>

  <!-- 4. BEGIN TX -->
  <line x1="794" y1="326" x2="948" y2="326" stroke="#334155" stroke-width="1.6" marker-end="url(#arr)"/>
  <text x="873" y="319" text-anchor="middle" font-size="9" font-weight="bold" fill="#0f172a">BEGIN TRANSACTION</text>

  <!-- 5. SELECT available -->
  <line x1="794" y1="356" x2="948" y2="356" stroke="#334155" stroke-width="1.6" marker-end="url(#arr)"/>
  <text x="873" y="349" text-anchor="middle" font-size="9" fill="#0f172a">SELECT available WHERE id=1</text>
  <!-- return -->
  <line x1="948" y1="382" x2="794" y2="382" stroke="#475569" stroke-width="1.4" stroke-dasharray="5 3" marker-end="url(#arr-open)"/>
  <text x="873" y="375" text-anchor="middle" font-size="9" fill="#475569">available = 100</text>

  <!-- 6. Guard check -->
  <rect x="716" y="392" width="148" height="18" rx="3" fill="#f0fdf4" stroke="#4ade80" stroke-width="1"/>
  <text x="790" y="405" text-anchor="middle" font-size="9" fill="#15803d" font-weight="bold">[guard]  100 â‰¥ 2  âœ“</text>

  <!-- 7. UPDATE events -->
  <line x1="794" y1="424" x2="948" y2="424" stroke="#334155" stroke-width="1.6" marker-end="url(#arr)"/>
  <text x="873" y="417" text-anchor="middle" font-size="9" fill="#0f172a">UPDATE available = 98</text>

  <!-- 8. INSERT booking -->
  <line x1="794" y1="456" x2="948" y2="456" stroke="#334155" stroke-width="1.6" marker-end="url(#arr)"/>
  <text x="873" y="449" text-anchor="middle" font-size="9" fill="#0f172a">INSERT INTO bookings</text>

  <!-- 9. COMMIT -->
  <line x1="794" y1="488" x2="948" y2="488" stroke="#334155" stroke-width="1.6" marker-end="url(#arr)"/>
  <text x="873" y="481" text-anchor="middle" font-size="9" font-weight="bold" fill="#0f172a">COMMIT</text>
  <line x1="948" y1="514" x2="794" y2="514" stroke="#475569" stroke-width="1.4" stroke-dasharray="5 3" marker-end="url(#arr-open)"/>
  <text x="873" y="507" text-anchor="middle" font-size="9" fill="#475569">OK</text>

  <!-- 10. Unlock mutex (self-loop) -->
  <path d="M 794 560 Q 840 560 840 570 Q 840 580 794 580" fill="none" stroke="#f59e0b" stroke-width="2" marker-end="url(#arr)"/>
  <!-- Unlock Mutex pill -->
  <rect x="844" y="564" width="112" height="18" rx="9" fill="#fef3c7" stroke="#f59e0b" stroke-width="1.3"/>
  <text x="900" y="576" text-anchor="middle" font-size="9" font-weight="bold" fill="#92400e">ðŸ”“ Unlock Mutex</text>

  <!-- 11. 201 Created R -->
  <line x1="778" y1="624" x2="622" y2="624" stroke="#475569" stroke-width="1.5" stroke-dasharray="5 3" marker-end="url(#arr-open)"/>
  <text x="701" y="616" text-anchor="middle" font-size="10" font-weight="bold" fill="#16a34a">201 Created</text>

  <!-- Response body note R -->
  <rect x="552" y="634" width="152" height="70" rx="3" fill="#f0fdf4" stroke="#4ade80" stroke-width="1" stroke-dasharray="4 2"/>
  <text x="566" y="650" font-size="9" fill="#166534">{ success: true,</text>
  <text x="566" y="664" font-size="9" fill="#166534">  message:</text>
  <text x="566" y="678" font-size="9" fill="#166534">   "Booking confirmed",</text>
  <text x="566" y="692" font-size="9" fill="#166534">  booking_id: 42 }</text>

  <!-- Sequence numbers R -->
  <circle cx="630" cy="158" r="8" fill="#0369a1"/><text x="630" y="162" text-anchor="middle" font-size="9" fill="#fff" font-weight="bold">1</text>
  <circle cx="840" cy="242" r="8" fill="#f59e0b"/><text x="840" y="246" text-anchor="middle" font-size="9" fill="#fff" font-weight="bold">2</text>
  <circle cx="801" cy="326" r="8" fill="#7c3aed"/><text x="801" y="330" text-anchor="middle" font-size="9" fill="#fff" font-weight="bold">3</text>
  <circle cx="801" cy="356" r="8" fill="#22c55e"/><text x="801" y="360" text-anchor="middle" font-size="9" fill="#fff" font-weight="bold">4</text>
  <circle cx="933" cy="382" r="8" fill="#7c3aed"/><text x="933" y="386" text-anchor="middle" font-size="9" fill="#fff" font-weight="bold">5</text>
  <circle cx="801" cy="424" r="8" fill="#22c55e"/><text x="801" y="428" text-anchor="middle" font-size="9" fill="#fff" font-weight="bold">6</text>
  <circle cx="801" cy="456" r="8" fill="#22c55e"/><text x="801" y="460" text-anchor="middle" font-size="9" fill="#fff" font-weight="bold">7</text>
  <circle cx="801" cy="488" r="8" fill="#7c3aed"/><text x="801" y="492" text-anchor="middle" font-size="9" fill="#fff" font-weight="bold">8</text>
  <circle cx="840" cy="560" r="8" fill="#f59e0b"/><text x="840" y="564" text-anchor="middle" font-size="9" fill="#fff" font-weight="bold">9</text>
  <circle cx="762" cy="624" r="8" fill="#16a34a"/><text x="762" y="628" text-anchor="middle" font-size="9" fill="#fff" font-weight="bold">10</text>

  <!-- Footer lifelines R -->
  <rect x="562" y="876" width="104" height="18" rx="4" fill="#fff" stroke="#38bdf8" stroke-width="1.5"/>
  <text x="614" y="889" text-anchor="middle" font-size="10" fill="#0f172a">Client</text>
  <rect x="734" y="876" width="104" height="18" rx="4" fill="#fff" stroke="#f59e0b" stroke-width="1.5"/>
  <text x="786" y="889" text-anchor="middle" font-size="10" fill="#0f172a">Server</text>
  <rect x="906" y="876" width="104" height="18" rx="4" fill="#fff" stroke="#a78bfa" stroke-width="1.5"/>
  <text x="958" y="889" text-anchor="middle" font-size="10" fill="#0f172a">Database</text>

</svg>
