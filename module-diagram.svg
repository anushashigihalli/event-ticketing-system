<svg viewBox="0 0 820 740" xmlns="http://www.w3.org/2000/svg" font-family="'Courier New', monospace">
  <defs>
    <marker id="arr" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0,10 3.5,0 7" fill="#334155"/>
    </marker>
    <marker id="arr-open" markerWidth="12" markerHeight="8" refX="11" refY="4" orient="auto">
      <polyline points="0,0 10,4 0,8" fill="none" stroke="#334155" stroke-width="1.5"/>
    </marker>
    <marker id="arr-dep" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0,10 3.5,0 7" fill="#6d28d9"/>
    </marker>
    <filter id="sh">
      <feDropShadow dx="1" dy="2" stdDeviation="2.5" flood-color="#00000018"/>
    </filter>
  </defs>

  <rect width="820" height="740" fill="#f8fafc"/>

  <!-- Title -->
  <text x="410" y="26" text-anchor="middle" font-size="14" font-weight="bold" fill="#0f172a" letter-spacing="0.5">Â«moduleÂ» main.go â€” Component Decomposition</text>

  <!-- â•â• PACKAGE BOUNDARY â•â• -->
  <rect x="30" y="38" width="760" height="635" rx="6" fill="#f1f5f9" stroke="#94a3b8" stroke-width="1.5" stroke-dasharray="8 4"/>
  <rect x="30" y="38" width="96" height="18" rx="3" fill="#e2e8f0" stroke="#94a3b8" stroke-width="1.3"/>
  <text x="78" y="51" text-anchor="middle" font-size="10" font-weight="bold" fill="#475569">Â«packageÂ»</text>
  <text x="410" y="62" text-anchor="middle" font-size="11" fill="#64748b" font-style="italic">package main  Â·  main.go</text>

  <!-- â•â• LAYER 1: main() â•â• -->
  <rect x="295" y="70" width="230" height="108" rx="5" fill="#fff" stroke="#38bdf8" stroke-width="2" filter="url(#sh)"/>
  <rect x="295" y="70" width="230" height="22" rx="5" fill="#0ea5e9"/>
  <rect x="295" y="84"  width="230" height="8"  fill="#0ea5e9"/>
  <text x="410" y="86" text-anchor="middle" font-size="11" font-weight="bold" fill="#fff">Â«entrypointÂ»  main()</text>
  <line x1="295" y1="102" x2="525" y2="102" stroke="#bae6fd" stroke-width="1"/>
  <text x="410" y="115" text-anchor="middle" font-size="9" fill="#475569">+ initDB() â†’ *sql.DB</text>
  <text x="410" y="128" text-anchor="middle" font-size="9" fill="#475569">+ runMigrations(db)</text>
  <text x="410" y="141" text-anchor="middle" font-size="9" fill="#475569">+ registerRoutes(mux)</text>
  <text x="410" y="154" text-anchor="middle" font-size="9" fill="#475569">+ http.ListenAndServe(:8080)</text>

  <!-- arrow main â†’ Handlers -->
  <line x1="410" y1="178" x2="410" y2="208" stroke="#334155" stroke-width="1.6" marker-end="url(#arr)"/>
  <text x="426" y="198" font-size="9" fill="#64748b">registers</text>

  <!-- â•â• LAYER 2: HTTP HANDLERS â•â• -->
  <rect x="60" y="208" width="700" height="148" rx="5" fill="#f0fdf4" stroke="#86efac" stroke-width="1.5"/>
  <rect x="60" y="208" width="108" height="18" rx="3" fill="#22c55e"/>
  <text x="114" y="221" text-anchor="middle" font-size="10" font-weight="bold" fill="#fff">Â«layerÂ»  Handlers</text>

  <!-- handleEvents â€” 190px wide -->
  <rect x="78"  y="230" width="190" height="112" rx="4" fill="#fff" stroke="#4ade80" stroke-width="1.5" filter="url(#sh)"/>
  <rect x="78"  y="230" width="190" height="20"  rx="4" fill="#4ade80"/>
  <rect x="78"  y="242" width="190" height="8"   fill="#4ade80"/>
  <text x="173" y="244" text-anchor="middle" font-size="10" font-weight="bold" fill="#fff">handleEvents()</text>
  <line x1="78"  y1="260" x2="268" y2="260" stroke="#bbf7d0" stroke-width="1"/>
  <text x="173" y="273" text-anchor="middle" font-size="9" fill="#475569">GET  /events</text>
  <text x="173" y="286" text-anchor="middle" font-size="9" fill="#475569">POST /events</text>
  <line x1="78"  y1="296" x2="268" y2="296" stroke="#e2e8f0" stroke-width="1" stroke-dasharray="4 2"/>
  <text x="173" y="308" text-anchor="middle" font-size="9" font-style="italic" fill="#94a3b8">â†’ getEvents()</text>
  <text x="173" y="321" text-anchor="middle" font-size="9" font-style="italic" fill="#94a3b8">â†’ createEvent()</text>
  <text x="173" y="334" text-anchor="middle" font-size="9" font-style="italic" fill="#94a3b8">â†’ sendResponse()</text>

  <!-- handleEventByID â€” 190px wide -->
  <rect x="285" y="230" width="190" height="112" rx="4" fill="#fff" stroke="#4ade80" stroke-width="1.5" filter="url(#sh)"/>
  <rect x="285" y="230" width="190" height="20"  rx="4" fill="#4ade80"/>
  <rect x="285" y="242" width="190" height="8"   fill="#4ade80"/>
  <text x="380" y="244" text-anchor="middle" font-size="10" font-weight="bold" fill="#fff">handleEventByID()</text>
  <line x1="285" y1="260" x2="475" y2="260" stroke="#bbf7d0" stroke-width="1"/>
  <text x="380" y="273" text-anchor="middle" font-size="9" fill="#475569">GET /events/{id}</text>
  <line x1="285" y1="283" x2="475" y2="283" stroke="#e2e8f0" stroke-width="1" stroke-dasharray="4 2"/>
  <text x="380" y="296" text-anchor="middle" font-size="9" font-style="italic" fill="#94a3b8">â†’ db.QueryRow()</text>
  <text x="380" y="309" text-anchor="middle" font-size="9" font-style="italic" fill="#94a3b8">â†’ sendResponse()</text>

  <!-- handleBookings â€” 210px wide, split long title -->
  <rect x="492" y="230" width="240" height="112" rx="4" fill="#fff" stroke="#4ade80" stroke-width="1.5" filter="url(#sh)"/>
  <rect x="492" y="230" width="240" height="20"  rx="4" fill="#4ade80"/>
  <rect x="492" y="242" width="240" height="8"   fill="#4ade80"/>
  <text x="612" y="244" text-anchor="middle" font-size="10" font-weight="bold" fill="#fff">handleBookings() + check</text>
  <line x1="492" y1="260" x2="732" y2="260" stroke="#bbf7d0" stroke-width="1"/>
  <text x="612" y="273" text-anchor="middle" font-size="9" fill="#475569">POST /bookings</text>
  <text x="612" y="286" text-anchor="middle" font-size="9" fill="#475569">GET  /bookings</text>
  <text x="612" y="299" text-anchor="middle" font-size="9" fill="#475569">GET  /bookings/check</text>
  <line x1="492" y1="308" x2="732" y2="308" stroke="#e2e8f0" stroke-width="1" stroke-dasharray="4 2"/>
  <text x="612" y="320" text-anchor="middle" font-size="9" font-style="italic" fill="#94a3b8">â†’ createBooking() ðŸ”’</text>
  <text x="612" y="333" text-anchor="middle" font-size="9" font-style="italic" fill="#94a3b8">â†’ getBookings()</text>

  <!-- arrows Handlers â†’ Helpers -->
  <line x1="200" y1="356" x2="240" y2="406" stroke="#334155" stroke-width="1.5" marker-end="url(#arr-open)"/>
  <line x1="410" y1="356" x2="410" y2="406" stroke="#334155" stroke-width="1.5" marker-end="url(#arr-open)"/>
  <line x1="600" y1="356" x2="550" y2="406" stroke="#334155" stroke-width="1.5" marker-end="url(#arr-open)"/>
  <text x="410" y="390" text-anchor="middle" font-size="9" fill="#64748b">Â«callÂ»</text>

  <!-- â•â• LAYER 3: HELPERS â•â• -->
  <rect x="60" y="406" width="700" height="140" rx="5" fill="#fef9f0" stroke="#fcd34d" stroke-width="1.5"/>
  <rect x="60" y="406" width="108" height="18" rx="3" fill="#f59e0b"/>
  <text x="114" y="419" text-anchor="middle" font-size="10" font-weight="bold" fill="#fff">Â«layerÂ»  Helpers</text>

  <!-- getEvents â€” 148px -->
  <rect x="78"  y="428" width="148" height="106" rx="4" fill="#fff" stroke="#fbbf24" stroke-width="1.5" filter="url(#sh)"/>
  <rect x="78"  y="428" width="148" height="20"  rx="4" fill="#fbbf24"/>
  <rect x="78"  y="440" width="148" height="8"   fill="#fbbf24"/>
  <text x="152" y="442" text-anchor="middle" font-size="10" font-weight="bold" fill="#fff">getEvents(db)</text>
  <line x1="78"  y1="458" x2="226" y2="458" stroke="#fde68a" stroke-width="1"/>
  <text x="152" y="472" text-anchor="middle" font-size="9" fill="#475569">â†’ []Event, error</text>
  <text x="152" y="486" text-anchor="middle" font-size="9" fill="#475569">db.Query(SELECTâ€¦)</text>
  <text x="152" y="500" text-anchor="middle" font-size="9" fill="#475569">rows.Scan()</text>
  <text x="152" y="514" text-anchor="middle" font-size="9" fill="#475569">rows.Close()</text>

  <!-- createEvent â€” 158px -->
  <rect x="240" y="428" width="158" height="106" rx="4" fill="#fff" stroke="#fbbf24" stroke-width="1.5" filter="url(#sh)"/>
  <rect x="240" y="428" width="158" height="20"  rx="4" fill="#fbbf24"/>
  <rect x="240" y="440" width="158" height="8"   fill="#fbbf24"/>
  <text x="319" y="442" text-anchor="middle" font-size="10" font-weight="bold" fill="#fff">createEvent(db, e)</text>
  <line x1="240" y1="458" x2="398" y2="458" stroke="#fde68a" stroke-width="1"/>
  <text x="319" y="472" text-anchor="middle" font-size="9" fill="#475569">â†’ Event, error</text>
  <text x="319" y="486" text-anchor="middle" font-size="9" fill="#475569">db.Exec(INSERTâ€¦)</text>
  <text x="319" y="500" text-anchor="middle" font-size="9" fill="#475569">LastInsertId()</text>

  <!-- createBooking (mutex highlighted) â€” 178px -->
  <rect x="414" y="424" width="178" height="114" rx="4" fill="#fff" stroke="#f59e0b" stroke-width="2.5" filter="url(#sh)"/>
  <rect x="414" y="424" width="178" height="20"  rx="4" fill="#d97706"/>
  <rect x="414" y="436" width="178" height="8"   fill="#d97706"/>
  <text x="503" y="438" text-anchor="middle" font-size="10" font-weight="bold" fill="#fff">createBooking(db, b)</text>
  <!-- mutex badge â€” positioned inside header, right-aligned -->
  <rect x="536" y="424" width="56" height="14" rx="7" fill="#f59e0b" stroke="#fff" stroke-width="1.5"/>
  <text x="564" y="435" text-anchor="middle" font-size="8" font-weight="bold" fill="#fff">ðŸ”’ MUTEX</text>
  <line x1="414" y1="454" x2="592" y2="454" stroke="#fde68a" stroke-width="1"/>
  <text x="503" y="467" text-anchor="middle" font-size="9" fill="#475569">â†’ Booking, error</text>
  <text x="503" y="480" text-anchor="middle" font-size="9" fill="#475569">Mutex.Lock()</text>
  <text x="503" y="493" text-anchor="middle" font-size="9" fill="#475569">tx.Begin() / Commit()</text>
  <text x="503" y="506" text-anchor="middle" font-size="9" fill="#475569">Mutex.Unlock()</text>
  <text x="503" y="519" text-anchor="middle" font-size="9" fill="#475569">defer Rollback()</text>

  <!-- utilities â€” 118px -->
  <rect x="610" y="428" width="132" height="106" rx="4" fill="#fff" stroke="#fbbf24" stroke-width="1.5" filter="url(#sh)"/>
  <rect x="610" y="428" width="132" height="20"  rx="4" fill="#fbbf24"/>
  <rect x="610" y="440" width="132" height="8"   fill="#fbbf24"/>
  <text x="676" y="442" text-anchor="middle" font-size="10" font-weight="bold" fill="#fff">utilities</text>
  <line x1="610" y1="458" x2="742" y2="458" stroke="#fde68a" stroke-width="1"/>
  <text x="676" y="472" text-anchor="middle" font-size="9" fill="#475569">sendResponse(w,â€¦)</text>
  <text x="676" y="486" text-anchor="middle" font-size="9" fill="#475569">getBookings(db)</text>
  <text x="676" y="500" text-anchor="middle" font-size="9" fill="#475569">json.NewEncoder(w)</text>

  <!-- arrows Helpers â†’ DB Ops -->
  <line x1="200" y1="548" x2="240" y2="582" stroke="#6d28d9" stroke-width="1.5" stroke-dasharray="5 3" marker-end="url(#arr-dep)"/>
  <line x1="410" y1="548" x2="410" y2="582" stroke="#6d28d9" stroke-width="1.5" stroke-dasharray="5 3" marker-end="url(#arr-dep)"/>
  <line x1="560" y1="548" x2="510" y2="582" stroke="#6d28d9" stroke-width="1.5" stroke-dasharray="5 3" marker-end="url(#arr-dep)"/>
  <text x="410" y="570" text-anchor="middle" font-size="9" fill="#7c3aed">Â«useÂ»</text>

  <!-- â•â• LAYER 4: DB OPS â•â• -->
  <rect x="60" y="582" width="700" height="60" rx="5" fill="#faf5ff" stroke="#c4b5fd" stroke-width="1.5"/>
  <rect x="60" y="582" width="108" height="18" rx="3" fill="#7c3aed"/>
  <text x="114" y="595" text-anchor="middle" font-size="10" font-weight="bold" fill="#fff">Â«layerÂ»  DB Ops</text>

  <!-- pills â€” evenly spaced -->
  <rect x="80"  y="603" width="90"  height="22" rx="11" fill="#ede9fe" stroke="#a78bfa" stroke-width="1.3"/>
  <text x="125" y="618" text-anchor="middle" font-size="9" fill="#4c1d95">db.Query()</text>

  <rect x="182" y="603" width="90"  height="22" rx="11" fill="#ede9fe" stroke="#a78bfa" stroke-width="1.3"/>
  <text x="227" y="618" text-anchor="middle" font-size="9" fill="#4c1d95">db.Exec()</text>

  <rect x="284" y="603" width="110" height="22" rx="11" fill="#ede9fe" stroke="#a78bfa" stroke-width="1.3"/>
  <text x="339" y="618" text-anchor="middle" font-size="9" fill="#4c1d95">db.QueryRow()</text>

  <rect x="406" y="603" width="90"  height="22" rx="11" fill="#ddd6fe" stroke="#7c3aed" stroke-width="1.5"/>
  <text x="451" y="618" text-anchor="middle" font-size="9" font-weight="bold" fill="#4c1d95">tx.Begin()</text>

  <rect x="508" y="603" width="96"  height="22" rx="11" fill="#ddd6fe" stroke="#7c3aed" stroke-width="1.5"/>
  <text x="556" y="618" text-anchor="middle" font-size="9" font-weight="bold" fill="#4c1d95">tx.Commit()</text>

  <rect x="616" y="603" width="106" height="22" rx="11" fill="#ddd6fe" stroke="#7c3aed" stroke-width="1.5"/>
  <text x="669" y="618" text-anchor="middle" font-size="9" font-weight="bold" fill="#4c1d95">tx.Rollback()</text>

  <!-- arrow DB ops â†’ SQLite -->
  <line x1="410" y1="655" x2="410" y2="676" stroke="#6d28d9" stroke-width="1.8" marker-end="url(#arr-dep)"/>
  <text x="428" y="670" font-size="9" fill="#7c3aed">Â«persistÂ»</text>

  <!-- â•â• SQLite cylinder â•â• -->
  <!-- cylinder body -->
  <rect x="290" y="686" width="240" height="34" rx="0" fill="#fff" stroke="#a78bfa" stroke-width="2"/>
  <!-- bottom arc -->
  <ellipse cx="410" cy="720" rx="120" ry="10" fill="#ede9fe" stroke="#a78bfa" stroke-width="2"/>
  <!-- top ellipse (cap) -->
  <ellipse cx="410" cy="686" rx="120" ry="10" fill="#ede9fe" stroke="#a78bfa" stroke-width="2"/>
  <!-- left/right sides clean cover -->
  <rect x="290" y="686" width="2"   height="34" fill="#fff"/>
  <rect x="528" y="686" width="2"   height="34" fill="#fff"/>
  <!-- stereo inside top ellipse -->
  <text x="410" y="690" text-anchor="middle" font-size="9" font-style="italic" fill="#6d28d9">Â«databaseÂ»</text>
  <!-- name in cylinder body -->
  <text x="410" y="710" text-anchor="middle" font-size="12" font-weight="bold" fill="#0f172a">events.db  (SQLite)</text>

</svg>
